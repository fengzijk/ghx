<!DOCTYPE html>
<html lang="zh-cn">
<head>
	<meta charset="UTF-8">
	<title>表格和按钮</title>
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="jedate/skin/jedate.css" />
</head>
<body style="margin:50px" class="table-responsive">
	
<div>
<ul>
<form class="form-inline">
	<div class="form-group">
		<input type="text" class="form-control" placeholder="请输入用户名">
	</div>
	<div class="form-group">
		<input type="text" class="form-control" placeholder="请选择起始日期" id="inpstart" readonly>
	</div>
	<div class="form-group">
		<input type="text" class="form-control" placeholder="请选择结束日期" id="inpend" readonly>
	</div>	
</form>
</ul>

<div>
<ul>
<button class="btn btn-primary" >Routes[Service]查询</button>
<button class="btn btn-primary" onclick="add(1,1)">Routes[Service]新增</button>
<button class="btn btn-primary">Routes[Service]更新</button>
<button class="btn btn-primary">Routes[Service]删除</button>				
</ul>
<ul>
<button class="btn btn-success">Routes[itself]查询</button>
<button class="btn btn-success" onclick="add(1,2)">Routes[itself]新增</button>
<button class="btn btn-success">Routes[itself]更新</button>
<button class="btn btn-success">Routes[itself]删除</button>		
</ul>
<ul>
<button class="btn btn-info">Feign查询</button>
<button class="btn btn-info" onclick="add(1,3)">Feign新增</button>
<button class="btn btn-info">Feign更新</button>
<button class="btn btn-info">Feign删除</button>	
</ul>
</div>

</div>
<div >
<table class="table table-hover">
	<thead>
		<tr>
			<th>编号</th>
			<th>姓名</th>
			<th>地址</th>
			<th>年龄</th>
			<th>类型</th>
			<th>电话</th>
			<th>生日</th>			
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>1</td>
			<td>张三</td>
			<td>北京</td>
			<td>18</td>
			<td>普通用户</td>
			<td>123456</td>
			<td>2000-08-08</td>
		</tr>
		<tr class="info">
			<td>2</td>
			<td>李四</td>
			<td>北京</td>
			<td>18</td>
			<td>普通用户</td>
			<td>123456</td>
			<td>2000-08-08</td>
		</tr>
		<tr class="success">
			<td>3</td>
			<td>王五</td>
			<td>北京</td>
			<td>18</td>
			<td>普通用户</td>
			<td>123456</td>
			<td>2000-08-08</td>
		</tr>
		<tr>
			<td>4</td>
			<td>马六</td>
			<td>北京</td>
			<td>18</td>
			<td>普通用户</td>
			<td>123456</td>
			<td>2000-08-08</td>
		</tr>
	</tbody>
</table>
<ul class="pagination" id="paging">
  <li><a href="#" onclick="topPage()">首页</a></li>
  <li><a href="#" onclick="upPage()">上一页</a></li>
  <li><a href="#" onclick="nextPage()">下一页</a></li>
  <li><a href="#" onclick="bottomPage()">尾页</a></li>
  <li><a href="#">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
  
  <li><a href="#">页码:0</a></li>
  <li><a href="#">记录:0</a></li>
   
</ul>
</div>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog"
     aria-labelledby="myModalLabel">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"
                aria-hidden="true">×
        </button>
        <h4 class="modal-title" id="myModalLabel">操作</h4><!-- 表达式[普通:秒,Cron:0 */5 * * * ?] -->
      </div>
      <div style="padding: 5px;">
        <div class="modal-body" data-scrollbar="true" data-height="400"
             data-scrollcolor="#000">
          <form action="javascript:;" class="form-horizontal" id="modalForm">
            <input type="hidden" id="id">
            <div class="form-group">
              <label class="col-sm-2 control-label">用户名</label>
              <div class="col-sm-8">
                <input type="text" id="username" value="" class="form-control">
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">地址</label>
              <div class="col-sm-8">
                <input type="text" id="address" value="" class="form-control">
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">年龄</label>
              <div class="col-sm-8">
                <input type="text" id="age" value="" class="form-control">
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">电话</label>
              <div class="col-sm-8">
                <input type="text" id="phone" value="" class="form-control">
              </div>
            </div>            
            <div class="form-group">
              <label class="col-sm-2 control-label">用户类型</label>
              <div class="col-sm-8">
                <select class="form-control" id="type">
                  <option value="1">管理员</option>
                  <option value="2">普通用户</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">日期</label>
              <div class="col-sm-8">
                <input type="text" id="birthday" value="" class="form-control">
              </div>
            </div>            
          </form>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" ng-click="save()">提交</button>
        <button class="btn btn-primary" ng-click="formReset()">重置</button>
      </div>
    </div>
  </div>
</div>

<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="jedate/jedate.min.js"></script>

<script type="text/javascript">
var serviceType = null;
var serviceApi = null;
var queryApi = null;
var start = {
    dateCell: '#inpstart',
    format: 'YYYY-MM-DD',
    minDate: '1970-01-01', //设定最小日期为当前日期
    zIndex:9999999,
    festival:true,
    ishmsVal:false,
    maxDate: '2099-12-30', //最大日期
    choosefun: function(elem,datas){
        end.minDate = datas; //开始日选好后，重置结束日的最小日期
    }
};
var end = {
    dateCell: '#inpend',
    zIndex:9999999,
    format: 'YYYY-MM-DD',
    minDate: '1970-01-01', //设定最小日期为当前日期
    festival:true,
    maxDate: '2099-12-30', //最大日期
    choosefun: function(elem,datas){
        start.maxDate = datas; //将结束日的初始值设定为开始日的最大日期
    }
};
var opt = {
    dateCell: '#birthday',
    zIndex:9999999,
    format: 'YYYY-MM-DD',
    minDate: '1970-01-01', //设定最小日期为当前日期
    festival:true,
    maxDate: '2099-12-30', //最大日期
    choosefun: function(elem,datas){
        start.maxDate = datas; //将结束日的初始值设定为开始日的最大日期
    }
};
jeDate(start);
jeDate(end);
jeDate(opt);



//增删改查
function add(optType,serviceType) {
	$('#myModal').modal();
	if(serviceType == 1){//routes service 直接访问的是service
		serviceApi = "http://localhost:9002/api-provider-id/user/add";
		queryApi = "";
	}else if(serviceType == 2){// routes itself
		serviceApi = "http://localhost:9002/api-admin/add";
		queryApi = "";
	}else{//feign 通过本地进行调用service层的接口来进行提供服务
		serviceApi = "http://localhost:9002/add";
		queryApi = "";
	}

}

function save(){
	//logic
	if(optType == 1){//add 直接展示模态框
		
		$.ajax({
			type:"post",
			url: serviceApi,
			dataType:"json",
			async:false,
			data:{"username":$('#username').val(),"address":$('#address').val(),
				   "age":$('#age').val(),"type":$('#type').val(),"phone":$('#phone').val(),
			        "birthday":$('#birthday').val()},
			success : function(data){
				alert(data);
				if(data.retCode == 1){
					$('#myModal').modal('hide');
					//--search
				}else{
					alert('新增失败');
				}
			}
		});
	}else{//update  获取相应API中的数据
		
	}	
}

function lastPage(page) {

}

function nextPage(page) {

}

function topPage(page) {

}

function bottomPage(page) {

}

function search(pageNo, serviceType) {
	$.ajax({
		type: "POST",
		url: "${ctx}/queryEsBykeyWord.shtml",
		data: "keyword=" + searchKey + "&currentPage=" + page,
		dataType: "json",
		success: function(msg) {
			$("#content").empty();
			$("#paging").empty();
			var rows = msg.rows;
			//alert(msg.totalPage);
			if(rows != null && rows.length > 0) {
				var bodyStr = "";
				for(var i = 0; i < rows.length; i++) {
					if(i % 2 == 0) {
						bodyStr = bodyStr + "<tr class=\"info\"><td>" + rows[i].search_key +
							"</td><td>" + rows[i].click_url + "</td><td>" + rows[i].vist_time + "</td><td>" +
							rows[i].hbase_key + "</td></tr>";
						/* bodyStr = bodyStr + "<tr class=\"info\"><td>"+rows[i].data_title
						+"</td><td>"+rows[i].start_time+"</td><td>"+rows[i].data_content+"</td><td>"+
						rows[i].product_code+"</td></tr>";*/
					} else {
						bodyStr = bodyStr + "<tr class=\"success\"><td>" + rows[i].search_key +
							"</td><td>" + rows[i].click_url + "</td><td>" + rows[i].vist_time + "</td><td>" +
							rows[i].hbase_key + "</td></tr>";
						/* bodyStr = bodyStr + "<tr class=\"success\"><td>"+rows[i].data_title
						+"</td><td>"+rows[i].start_time+"</td><td>"+rows[i].data_content+"</td><td>"+
						rows[i].product_code+"</td></tr>"; */
					}
				}

				//分页信息
				var page = "<li><a href=\"#\" onclick=\"toppage(" + msg.topPageNo + ")\">首页</a></li>" +
					"<li><a href=\"#\" onclick=\"up(" + msg.previousPageNo + ")\">上一页</a></li>" +
					"<li><a href=\"#\" onclick=\"next(" + msg.nextPageNo + ")\">下一页</a></li>" +
					"<li><a href=\"#\" onclick=\"bottom(" + msg.bottomPageNo + ")\">尾页</a></li>" +
					"<li><a href=\"#\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>" +
					"<li><a href=\"#\">总页:" + msg.totalPage + "</a></li><li><a href=\"#\">记录:" + msg.total + "</a></li>";

				$("#content").append(bodyStr);
				$("#paging").append(page);
			} else {
				$("#content").append("检索内容为空")
			}
			//end
			parent.ss();
		}
	});
}

</script>
</body>
</html>